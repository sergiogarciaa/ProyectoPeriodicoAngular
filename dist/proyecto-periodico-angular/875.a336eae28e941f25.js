"use strict";(self.webpackChunkProyectoPeriodicoAngular=self.webpackChunkProyectoPeriodicoAngular||[]).push([[875],{5875:(O,f,n)=>{n.r(f),n.d(f,{NoticiasModule:()=>J});var m=n(6814),u=n(9692),o=n(5879);let h=(()=>{class e{static#o=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-noticias"]],decls:1,vars:0,template:function(i,r){1&i&&o._UZ(0,"router-outlet")},dependencies:[u.lC]})}return e})();var p=n(3519),c=n.n(p),v=n(4004),l=n(3960),x=n(5592);let b=(()=>{class e{constructor(t){this.fbs=t}obtenerComentariosPorNoticia(t){const i=(0,l.hJ)(this.fbs,"comentarios"),r=(0,l.IO)(i,(0,l.ar)("idNoticia","==",t));return(0,l.BS)(r,{idField:"id"})}agregarComentario(t){const i=(0,l.hJ)(this.fbs,"comentarios");return new x.y(r=>{(0,l.ET)(i,t).then(()=>{r.next(),r.complete()}).catch(a=>{r.error(a)})})}static#o=this.\u0275fac=function(i){return new(i||e)(o.LFG(l.gg))};static#t=this.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var C=n(5449),y=n(2253),Z=n(8215),s=n(95);function N(e,d){if(1&e&&(o.TgZ(0,"div",8)(1,"div",17)(2,"div",18)(3,"h1",19),o._uU(4),o.qZA(),o.TgZ(5,"p",20),o._uU(6),o.qZA()(),o.TgZ(7,"div",21)(8,"p",22),o._uU(9),o.qZA()(),o.TgZ(10,"div",23)(11,"p",24),o._uU(12),o.qZA()()()()),2&e){const t=o.oxw();o.xp6(4),o.Oqu(t.noticia.titulo),o.xp6(2),o.Oqu(t.noticia.categoria),o.xp6(3),o.Oqu(t.noticia.cuerpo),o.xp6(3),o.hij("Escrito por: ",t.noticia.autor,"")}}function w(e,d){1&e&&(o.TgZ(0,"div")(1,"p"),o._uU(2,"No hay comentarios"),o.qZA(),o._UZ(3,"hr",25),o.qZA())}function T(e,d){if(1&e){const t=o.EpF();o.TgZ(0,"div"),o.O4$(),o.TgZ(1,"svg",31),o.NdJ("click",function(){o.CHM(t);const r=o.oxw().$implicit,a=o.oxw(2);return o.KtG(r.id&&a.borrarComentario(r.id))}),o._UZ(2,"path",32),o.qZA()()}}function _(e,d){if(1&e&&(o.TgZ(0,"div",27)(1,"div",21)(2,"div",28),o._uU(3),o.YNc(4,T,3,0,"div",29),o.qZA(),o.TgZ(5,"p",30),o._uU(6),o.qZA()()()),2&e){const t=d.$implicit,i=o.oxw(2);o.xp6(3),o.hij("",t.autor," "),o.xp6(1),o.Q6J("ngIf",i.idUsuario==t.idUsuario||"Admin"==i.usuarioRol),o.xp6(2),o.Oqu(t.contenido)}}function A(e,d){if(1&e&&o.YNc(0,_,7,3,"div",26),2&e){const t=o.oxw();o.Q6J("ngForOf",t.comentarios)}}const U=[{path:"",component:h,children:[{path:"ver-noticia/:id",component:(()=>{class e{constructor(t,i,r,a,g){this.route=t,this.comentarioService=i,this.auth=r,this.noticiasService=a,this.baseDatos=g,this.comentarios=[],this.nuevoComentario=""}ngOnInit(){this.route.params.subscribe(t=>{this.usuario=t.usuarioNombre,this.idUsuario=t.usuarioId,this.usuarioRol=t.usuarioRol}),this.route.params.subscribe(t=>{this.noticiasService.obtenerNoticiaPorId(t.id).subscribe(r=>{this.noticia=r,this.obtenerComentarios()})})}borrarComentario(t){this.baseDatos.eliminar("comentarios",t).then(()=>{c().fire("\xa1\xc9xito!","Comentario eliminado con \xe9xito","success"),this.obtenerComentarios()}).catch(i=>{c().fire("\xa1Error!","Error al eliminar el comentario","error"),console.error("Error al eliminar el comentario:",i)})}obtenerComentarios(){this.noticia&&this.noticia.id?this.comentarioService.obtenerComentariosPorNoticia(this.noticia.id).subscribe(t=>{this.comentarios=t,console.log(t)},t=>{c().fire("\xa1Error!","Error al obtener los comentarios:","error"),console.error("Error al obtener los comentarios:",t)}):(c().fire("\xa1Error!","No se ha encontrado la noticia","error"),console.error("El ID de la noticia es undefined"))}convertirTimestampADate(t){return t instanceof Date?t:t&&"function"==typeof t.toDate?t.toDate():t&&"number"==typeof t.seconds?new Date(1e3*t.seconds):new Date}agregarComentario(){const t=(0,v.Z)();if(""!==this.nuevoComentario.trim()){const i={id:t,contenido:this.nuevoComentario,autor:this.usuario,idUsuario:this.idUsuario,fechaPublicacion:this.convertirTimestampADate(new Date),idNoticia:this.noticia?.id};this.comentarioService.agregarComentario(i).subscribe(()=>{this.nuevoComentario="",c().fire("\xa1\xc9xito!","Comentario agregado con \xe9xito","success"),this.obtenerComentarios()},r=>{c().fire("\xa1Error!","Error al agregar el comentario","error"),console.error("Error al agregar el comentario:",r)})}else c().fire("\xa1Comentario vac\xedo!","No puede estar vac\xedo","info"),console.error("El comentario est\xe1 vac\xedo.")}logOut(){this.auth.logout()}static#o=this.\u0275fac=function(i){return new(i||e)(o.Y36(u.gz),o.Y36(b),o.Y36(C.e),o.Y36(y.D),o.Y36(Z.g))};static#t=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-ver-noticia"]],decls:24,vars:4,consts:[[1,"bg-gray-50","dark:bg-gray-900"],[1,"flex","justify-between","pt-4","pl-10"],[1,"justify-center","flex"],[1,"h-auto","text-3xl","text-gray-900","dark:text-gray-50"],[1,"flex","justify-end","py-2","pr-5","gap-5"],["routerLink","/principal/dashboard",1,"w-32","text-white","bg-red-600","hover:bg-red-500","focus:ring-4","focus:outline-none","focus:ring-red-500","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-red-600","dark:hover:bg-red-700","dark:focus:ring-red-800"],[1,"w-28","text-white","bg-red-600","hover:bg-red-500","focus:ring-4","focus:outline-none","focus:ring-red-500","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","dark:bg-red-600","dark:hover:bg-red-700","dark:focus:ring-red-800",3,"click"],["class","max-w-4xl mx-auto px-4 py-8",4,"ngIf"],[1,"max-w-4xl","mx-auto","px-4","py-8"],[1,"text-2xl","font-semibold","mb-4"],[4,"ngIf","ngIfElse"],["comentariosTemplate",""],[1,"mb-4",3,"ngSubmit"],[1,"flex","flex-col","mb-4"],["for","contenido",1,"mb-2"],["id","contenido","name","contenido","rows","4","placeholder","Escribe tu comentario aqu\xed...","required","",1,"border","rounded-lg","p-2",3,"ngModel","ngModelChange"],["type","submit",1,"bg-blue-500","text-white","font-semibold","py-2","px-4","rounded","hover:bg-blue-600"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden"],[1,"px-6","py-4","bg-gray-800"],[1,"text-3xl","font-semibold","text-white"],[1,"text-sm","text-gray-400"],[1,"px-6","py-4"],[1,"text-gray-700","word-break"],[1,"px-6","py-4","bg-gray-100"],[1,"text-sm","text-gray-600"],[1,"mb-8","mt-8"],["class","bg-white rounded-lg shadow-lg overflow-hidden mb-4",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-lg","overflow-hidden","mb-4"],[1,"font-semibold","flex","justify-between"],[4,"ngIf"],[1,"text-gray-700"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"]],template:function(i,r){if(1&i&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),o._uU(4,"La Revista"),o.qZA()(),o.TgZ(5,"div",4)(6,"a",5),o._uU(7,"Volver"),o.qZA(),o.TgZ(8,"button",6),o.NdJ("click",function(){return r.logOut()}),o._uU(9,"Salir"),o.qZA()()()(),o.YNc(10,N,13,4,"div",7),o.TgZ(11,"div",8)(12,"h2",9),o._uU(13,"Comentarios"),o.qZA(),o.YNc(14,w,4,0,"div",10),o.YNc(15,A,1,1,"ng-template",null,11,o.W1O),o.TgZ(17,"form",12),o.NdJ("ngSubmit",function(){return r.agregarComentario()}),o.TgZ(18,"div",13)(19,"label",14),o._uU(20,"Agregar comentario:"),o.qZA(),o.TgZ(21,"textarea",15),o.NdJ("ngModelChange",function(g){return r.nuevoComentario=g}),o.qZA()(),o.TgZ(22,"button",16),o._uU(23,"Enviar"),o.qZA()()()),2&i){const a=o.MAs(16);o.xp6(10),o.Q6J("ngIf",r.noticia),o.xp6(4),o.Q6J("ngIf",!r.comentarios||0===r.comentarios.length)("ngIfElse",a),o.xp6(7),o.Q6J("ngModel",r.nuevoComentario)}},dependencies:[u.rH,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.On,s.F,m.sg,m.O5]})}return e})()}]}];let E=(()=>{class e{static#o=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=o.oAB({type:e});static#e=this.\u0275inj=o.cJS({imports:[u.Bz.forChild(U),u.Bz]})}return e})(),J=(()=>{class e{static#o=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=o.oAB({type:e});static#e=this.\u0275inj=o.cJS({imports:[E,s.u5,m.ez]})}return e})()}}]);